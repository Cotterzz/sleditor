<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <title>SL Editor - UI System Prototype</title>
    
    <!-- Google Fonts for themes (including CJK support) -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <!-- Latin fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Fira+Code:wght@400;500&family=IBM+Plex+Sans:wght@400;500;600&family=Inter:wght@400;500;600&family=JetBrains+Mono:wght@400;500&family=Share+Tech+Mono&family=VT323&display=swap" rel="stylesheet">
    <!-- Japanese fonts (Noto Sans JP for UI/content, Noto Sans Mono for code) -->
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@400;500;600&family=Noto+Sans+Mono:wght@400;500&display=swap" rel="stylesheet">
    
    <!-- UI Stylesheet -->
    <link rel="stylesheet" href="ui.css">
    
    <style>
        /* Demo-specific styles */
        .demo-content {
            padding: 16px;
        }
        
        .demo-content h3 {
            margin-bottom: 12px;
            color: var(--text-primary);
        }
        
        .demo-content p {
            color: var(--text-secondary);
            margin-bottom: 12px;
            line-height: 1.6;
        }
        
        .demo-code {
            font-family: var(--font-code);
            background: var(--bg-primary);
            padding: 12px;
            border-radius: calc(var(--border-radius) * 0.5);
            border: 1px solid var(--border);
            color: var(--accent);
            font-size: 0.8rem;
            overflow-x: auto;
            white-space: pre;
        }
        
        .demo-preview {
            width: 100%;
            height: 200px;
            background: linear-gradient(135deg, var(--accent) 0%, var(--bg-tertiary) 100%);
            border-radius: var(--border-radius);
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--text-inverse);
            font-weight: 600;
        }
        
        .demo-section {
            margin-bottom: 24px;
        }
        
        .demo-section-title {
            font-size: 0.75rem;
            text-transform: uppercase;
            letter-spacing: 0.1em;
            color: var(--text-muted);
            margin-bottom: 12px;
            padding-bottom: 8px;
            border-bottom: 1px solid var(--border);
        }
        
        .demo-row {
            display: flex;
            gap: 16px;
            flex-wrap: wrap;
            margin-bottom: 16px;
        }
        
        .demo-box {
            flex: 1;
            min-width: 200px;
            padding: 16px;
            background: var(--bg-secondary);
            border-radius: var(--border-radius);
            border: 1px solid var(--border);
        }
        
        .demo-label {
            font-size: 0.7rem;
            color: var(--text-muted);
            margin-bottom: 8px;
        }
    </style>
</head>
<body>
    <!-- App will be built by JavaScript -->
    <noscript>
        <div style="padding: 2rem; text-align: center; color: #fff; background: #1a1a2e;">
            <h1>JavaScript Required</h1>
            <p>Please enable JavaScript to use SL Editor.</p>
        </div>
    </noscript>
    
    <!-- UI Module (ES modules, source of truth is /src/) -->
    <script type="module">
        import SLUI from './src/index.js';
        // Keep the global for parity with older demos
        window.SLUI = SLUI;

        // Keep title static
        document.title = `SL Editor - UI System Prototype`;
        
        // Initialize UI system
        SLUI.init().then(() => {
            
            // ========================================
            // COMPONENTS SHOWCASE PANEL
            // ========================================
            
            SLUI.registerPanel({
                id: 'components',
                icon: 'üß©',
                title: 'Components',
                createContent: () => {
                    const div = document.createElement('div');
                    div.className = 'demo-content';
                    
                    // SLIDERS SECTION
                    const slidersSection = document.createElement('div');
                    slidersSection.className = 'demo-section';
                    slidersSection.innerHTML = '<div class="demo-section-title">Sliders</div>';
                    
                    // Basic Slider
                    const sliderBox1 = document.createElement('div');
                    sliderBox1.className = 'demo-box';
                    sliderBox1.innerHTML = '<div class="demo-label">Basic Slider</div>';
                    const basicSlider = SLUI.Slider({ 
                        min: 0, max: 100, value: 50,
                        onInput: (v) => console.log('Slider value:', v)
                    });
                    sliderBox1.appendChild(basicSlider);
                    
                    // Labeled Slider
                    const sliderBox2 = document.createElement('div');
                    sliderBox2.className = 'demo-box';
                    sliderBox2.innerHTML = '<div class="demo-label">Labeled Slider (with min/max)</div>';
                    const labeledSlider = SLUI.LabeledSlider({ 
                        min: 0, max: 1, value: 0.5, step: 0.01,
                        valueFormat: v => v.toFixed(2)
                    });
                    sliderBox2.appendChild(labeledSlider);
                    
                    // Slider Group
                    const sliderBox3 = document.createElement('div');
                    sliderBox3.className = 'demo-box';
                    sliderBox3.innerHTML = '<div class="demo-label">Slider Group (with input)</div>';
                    const sliderGroup = SLUI.SliderGroup({ 
                        label: 'Opacity', 
                        min: 0, max: 100, value: 75,
                        onChange: (v) => console.log('Opacity:', v)
                    });
                    sliderBox3.appendChild(sliderGroup);
                    
                    // Decimal Slider Group
                    const sliderBox4 = document.createElement('div');
                    sliderBox4.className = 'demo-box';
                    sliderBox4.innerHTML = '<div class="demo-label">Decimal Slider Group</div>';
                    const decimalSlider = SLUI.SliderGroup({ 
                        label: 'Scale', 
                        min: 0.1, max: 2.0, value: 1.0, step: 0.1,
                        valueFormat: v => v.toFixed(1)
                    });
                    sliderBox4.appendChild(decimalSlider);
                    
                    const sliderRow = document.createElement('div');
                    sliderRow.className = 'demo-row';
                    sliderRow.appendChild(sliderBox1);
                    sliderRow.appendChild(sliderBox2);
                    slidersSection.appendChild(sliderRow);
                    
                    const sliderRow2 = document.createElement('div');
                    sliderRow2.className = 'demo-row';
                    sliderRow2.appendChild(sliderBox3);
                    sliderRow2.appendChild(sliderBox4);
                    slidersSection.appendChild(sliderRow2);
                    
                    div.appendChild(slidersSection);
                    
                    // TABS SECTION
                    const tabsSection = document.createElement('div');
                    tabsSection.className = 'demo-section';
                    tabsSection.innerHTML = '<div class="demo-section-title">Tabs</div>';
                    
                    // Default Tabs
                    const tabsBox1 = document.createElement('div');
                    tabsBox1.className = 'demo-box';
                    tabsBox1.innerHTML = '<div class="demo-label">Default Tabs</div>';
                    const defaultTabs = SLUI.Tabs({
                        tabs: [
                            { id: 'main', label: 'Main', icon: 'üìÑ', content: '<p style="color: var(--text-secondary);">Main shader code goes here.</p>' },
                            { id: 'bufferA', label: 'Buffer A', icon: 'üÖ∞Ô∏è', content: '<p style="color: var(--text-secondary);">Buffer A code for multi-pass rendering.</p>' },
                            { id: 'bufferB', label: 'Buffer B', icon: 'üÖ±Ô∏è', content: '<p style="color: var(--text-secondary);">Buffer B for additional passes.</p>' }
                        ],
                        onTabChange: (id) => console.log('Tab changed:', id)
                    });
                    tabsBox1.appendChild(defaultTabs);
                    
                    // Pills Tabs
                    const tabsBox2 = document.createElement('div');
                    tabsBox2.className = 'demo-box';
                    tabsBox2.innerHTML = '<div class="demo-label">Pills Variant</div>';
                    const pillsTabs = SLUI.Tabs({
                        tabs: [
                            { id: 'glsl', label: 'GLSL', content: '<p style="color: var(--text-secondary);">OpenGL Shading Language</p>' },
                            { id: 'wgsl', label: 'WGSL', content: '<p style="color: var(--text-secondary);">WebGPU Shading Language</p>' },
                            { id: 'hlsl', label: 'HLSL', content: '<p style="color: var(--text-secondary);">DirectX Shading Language</p>' }
                        ],
                        variant: 'pills'
                    });
                    tabsBox2.appendChild(pillsTabs);
                    
                    // Underline Tabs
                    const tabsBox3 = document.createElement('div');
                    tabsBox3.className = 'demo-box';
                    tabsBox3.innerHTML = '<div class="demo-label">Underline Variant</div>';
                    const underlineTabs = SLUI.Tabs({
                        tabs: [
                            { id: 'code', label: 'Code', content: '<p style="color: var(--text-secondary);">Shader source code editor.</p>' },
                            { id: 'uniforms', label: 'Uniforms', content: '<p style="color: var(--text-secondary);">Uniform variables and controls.</p>' },
                            { id: 'channels', label: 'Channels', content: '<p style="color: var(--text-secondary);">Input channels: textures, audio, video.</p>' }
                        ],
                        variant: 'underline'
                    });
                    tabsBox3.appendChild(underlineTabs);
                    
                    // Closable Tabs
                    const tabsBox4 = document.createElement('div');
                    tabsBox4.className = 'demo-box';
                    tabsBox4.innerHTML = '<div class="demo-label">Closable + Addable</div>';
                    let tabCounter = 3;
                    const closableTabs = SLUI.Tabs({
                        tabs: [
                            { id: 'tab1', label: 'Tab 1', content: '<p style="color: var(--text-secondary);">First tab content</p>' },
                            { id: 'tab2', label: 'Tab 2', content: '<p style="color: var(--text-secondary);">Second tab content</p>' }
                        ],
                        closable: true,
                        addable: true,
                        onTabAdd: () => ({ 
                            id: 'tab' + (++tabCounter), 
                            label: 'Tab ' + tabCounter, 
                            content: '<p style="color: var(--text-secondary);">New tab content</p>' 
                        }),
                        onTabClose: (id) => console.log('Closing tab:', id)
                    });
                    tabsBox4.appendChild(closableTabs);
                    
                    const tabsRow = document.createElement('div');
                    tabsRow.className = 'demo-row';
                    tabsRow.appendChild(tabsBox1);
                    tabsRow.appendChild(tabsBox2);
                    tabsSection.appendChild(tabsRow);
                    
                    const tabsRow2 = document.createElement('div');
                    tabsRow2.className = 'demo-row';
                    tabsRow2.appendChild(tabsBox3);
                    tabsRow2.appendChild(tabsBox4);
                    tabsSection.appendChild(tabsRow2);
                    
                    div.appendChild(tabsSection);

                    // TABPANE SECTION - Advanced draggable tabs
                    const tabPaneSection = document.createElement('div');
                    tabPaneSection.className = 'demo-section';
                    tabPaneSection.innerHTML = '<div class="demo-section-title">TabPane (Draggable)</div>';

                    const tabPaneRow = document.createElement('div');
                    tabPaneRow.className = 'demo-row';
                    tabPaneRow.style.minHeight = '200px';

                    // TabPane 1 - Code group
                    const paneBox1 = document.createElement('div');
                    paneBox1.className = 'demo-box';
                    paneBox1.style.display = 'flex';
                    paneBox1.style.flexDirection = 'column';
                    paneBox1.innerHTML = '<div class="demo-label">TabPane 1 (code group) - Drag tabs!</div>';
                    
                    const tabPane1 = SLUI.TabPane({
                        id: 'pane1',
                        group: 'code',
                        tabs: [
                            { id: 'main', label: 'main.glsl', icon: 'üìÑ', content: '<div style="padding: 12px; color: var(--text-secondary); font-family: var(--font-code);">// Main shader code<br>void mainImage(...) { }</div>' },
                            { id: 'bufferA', label: 'bufferA.glsl', icon: 'üÖ∞Ô∏è', content: '<div style="padding: 12px; color: var(--text-secondary); font-family: var(--font-code);">// Buffer A code</div>' },
                            { id: 'common', label: 'common.glsl', icon: 'üì¶', content: '<div style="padding: 12px; color: var(--text-secondary); font-family: var(--font-code);">// Shared functions</div>' }
                        ],
                        onTabChange: (id) => console.log('Pane1 tab changed:', id),
                        onTabClose: (id) => console.log('Pane1 tab closed:', id),
                        // No onTabDragOut = tabs won't be removed when dragged outside
                        onEmpty: () => console.log('Pane1 is empty!')
                    });
                    paneBox1.appendChild(tabPane1);

                    // TabPane 2 - Code group (same group, can exchange tabs)
                    const paneBox2 = document.createElement('div');
                    paneBox2.className = 'demo-box';
                    paneBox2.style.display = 'flex';
                    paneBox2.style.flexDirection = 'column';
                    paneBox2.innerHTML = '<div class="demo-label">TabPane 2 (code group) - Same group!</div>';
                    
                    const tabPane2 = SLUI.TabPane({
                        id: 'pane2',
                        group: 'code',
                        tabs: [
                            { id: 'audio', label: 'audio.glsl', icon: 'üîä', content: '<div style="padding: 12px; color: var(--text-secondary); font-family: var(--font-code);">// Audio shader</div>' },
                            { id: 'post', label: 'post.glsl', icon: 'üé®', content: '<div style="padding: 12px; color: var(--text-secondary); font-family: var(--font-code);">// Post-processing</div>' }
                        ],
                        onTabChange: (id) => console.log('Pane2 tab changed:', id)
                    });
                    paneBox2.appendChild(tabPane2);

                    tabPaneRow.appendChild(paneBox1);
                    tabPaneRow.appendChild(paneBox2);
                    tabPaneSection.appendChild(tabPaneRow);

                    // TabPane 3 - Different group (cannot exchange with code group)
                    const tabPaneRow2 = document.createElement('div');
                    tabPaneRow2.className = 'demo-row';
                    tabPaneRow2.style.minHeight = '150px';

                    const paneBox3 = document.createElement('div');
                    paneBox3.className = 'demo-box';
                    paneBox3.style.display = 'flex';
                    paneBox3.style.flexDirection = 'column';
                    paneBox3.innerHTML = '<div class="demo-label">TabPane 3 (gallery group) - Different group, no mixing!</div>';
                    
                    const tabPane3 = SLUI.TabPane({
                        id: 'pane3',
                        group: 'gallery',
                        tabs: [
                            { id: 'shaders', label: 'Shaders', icon: 'üé¨', content: '<div style="padding: 12px; color: var(--text-secondary);">Shader gallery...</div>' },
                            { id: 'textures', label: 'Textures', icon: 'üñºÔ∏è', content: '<div style="padding: 12px; color: var(--text-secondary);">Texture library...</div>' },
                            { id: 'audio', label: 'Audio', icon: 'üéµ', content: '<div style="padding: 12px; color: var(--text-secondary);">Audio samples...</div>' }
                        ]
                    });
                    paneBox3.appendChild(tabPane3);

                    tabPaneRow2.appendChild(paneBox3);
                    tabPaneSection.appendChild(tabPaneRow2);

                    div.appendChild(tabPaneSection);

                    // BUTTONS SECTION
                    const buttonsSection = document.createElement('div');
                    buttonsSection.className = 'demo-section';
                    buttonsSection.innerHTML = '<div class="demo-section-title">Buttons</div>';

                    // Row 1: Basic button variants
                    const btnRow1 = document.createElement('div');
                    btnRow1.className = 'demo-row';
                    btnRow1.style.gap = '12px';
                    btnRow1.style.flexWrap = 'wrap';

                    // Label only
                    const btn1 = SLUI.Button({ label: 'Default', onClick: () => console.log('Default clicked') });
                    const btn2 = SLUI.Button({ label: 'Primary', variant: 'primary', onClick: () => console.log('Primary clicked') });
                    const btn3 = SLUI.Button({ label: 'Danger', variant: 'danger', onClick: () => console.log('Danger clicked') });
                    const btn4 = SLUI.Button({ label: 'Ghost', variant: 'ghost', onClick: () => console.log('Ghost clicked') });
                    const btn5 = SLUI.Button({ label: 'Disabled', disabled: true });

                    btnRow1.appendChild(btn1);
                    btnRow1.appendChild(btn2);
                    btnRow1.appendChild(btn3);
                    btnRow1.appendChild(btn4);
                    btnRow1.appendChild(btn5);
                    buttonsSection.appendChild(btnRow1);

                    // Row 2: Icon buttons
                    const btnRow2 = document.createElement('div');
                    btnRow2.className = 'demo-row';
                    btnRow2.style.gap = '12px';
                    btnRow2.style.flexWrap = 'wrap';
                    btnRow2.style.marginTop = '12px';

                    const iconBtn1 = SLUI.Button({ icon: '‚ñ∂', tooltip: 'Play' });
                    const iconBtn2 = SLUI.Button({ icon: '‚è∏', tooltip: 'Pause' });
                    const iconBtn3 = SLUI.Button({ icon: '‚èπ', tooltip: 'Stop' });
                    const iconBtn4 = SLUI.Button({ icon: 'üîÅ', tooltip: 'Loop' });
                    const iconBtn5 = SLUI.Button({ icon: '‚ûï', variant: 'primary', tooltip: 'Add' });
                    const iconBtn6 = SLUI.Button({ icon: 'üóë', variant: 'danger', tooltip: 'Delete' });

                    // Attach tooltips
                    SLUI.Tooltip(iconBtn1, 'Play');
                    SLUI.Tooltip(iconBtn2, 'Pause');
                    SLUI.Tooltip(iconBtn3, 'Stop');
                    SLUI.Tooltip(iconBtn4, 'Loop');
                    SLUI.Tooltip(iconBtn5, 'Add Keyframe');
                    SLUI.Tooltip(iconBtn6, 'Delete');

                    btnRow2.appendChild(iconBtn1);
                    btnRow2.appendChild(iconBtn2);
                    btnRow2.appendChild(iconBtn3);
                    btnRow2.appendChild(iconBtn4);
                    btnRow2.appendChild(iconBtn5);
                    btnRow2.appendChild(iconBtn6);
                    buttonsSection.appendChild(btnRow2);

                    // Row 3: Icon + Label
                    const btnRow3 = document.createElement('div');
                    btnRow3.className = 'demo-row';
                    btnRow3.style.gap = '12px';
                    btnRow3.style.flexWrap = 'wrap';
                    btnRow3.style.marginTop = '12px';

                    const comboBtn1 = SLUI.Button({ icon: 'üíæ', label: 'Save', variant: 'primary' });
                    const comboBtn2 = SLUI.Button({ icon: 'üìÇ', label: 'Open' });
                    const comboBtn3 = SLUI.Button({ icon: '‚öôÔ∏è', label: 'Settings' });
                    const comboBtn4 = SLUI.Button({ icon: 'üîß', label: 'Compile', size: 'large' });

                    btnRow3.appendChild(comboBtn1);
                    btnRow3.appendChild(comboBtn2);
                    btnRow3.appendChild(comboBtn3);
                    btnRow3.appendChild(comboBtn4);
                    buttonsSection.appendChild(btnRow3);

                    // Row 4: Toggle buttons
                    const btnRow4 = document.createElement('div');
                    btnRow4.className = 'demo-row';
                    btnRow4.style.gap = '12px';
                    btnRow4.style.flexWrap = 'wrap';
                    btnRow4.style.marginTop = '12px';

                    // Play/Pause using i18n keys - labels auto-update on language change
                    const playPauseBtn = SLUI.ToggleButton({
                        iconOff: '‚ñ∂',
                        iconOn: '‚è∏',
                        labelOffKey: 'transport.play',
                        labelOnKey: 'transport.pause',
                        onToggle: (pressed) => console.log('Play/Pause:', pressed ? 'playing' : 'paused')
                    });

                    // Mute using i18n keys for tooltips
                    const muteBtn = SLUI.ToggleButton({
                        iconOff: 'üîä',
                        iconOn: 'üîá',
                        tooltipOffKey: 'transport.mute',
                        tooltipOnKey: 'transport.unmute',
                        onToggle: (pressed) => console.log('Mute:', pressed)
                    });

                    // Loop using i18n keys
                    const loopBtn = SLUI.ToggleButton({
                        iconOff: 'üîÅ',
                        iconOn: 'üîÅ',
                        tooltipOffKey: 'transport.loop',
                        tooltipOnKey: 'transport.loopOff',
                        onToggle: (pressed) => console.log('Loop:', pressed)
                    });

                    btnRow4.appendChild(playPauseBtn);
                    btnRow4.appendChild(muteBtn);
                    btnRow4.appendChild(loopBtn);
                    buttonsSection.appendChild(btnRow4);

                    // Row 5: Button sizes
                    const btnRow5 = document.createElement('div');
                    btnRow5.className = 'demo-row';
                    btnRow5.style.gap = '12px';
                    btnRow5.style.alignItems = 'center';
                    btnRow5.style.marginTop = '12px';

                    const smallBtn = SLUI.Button({ label: 'Small', size: 'small' });
                    const mediumBtn = SLUI.Button({ label: 'Medium', size: 'medium' });
                    const largeBtn = SLUI.Button({ label: 'Large', size: 'large' });

                    btnRow5.appendChild(smallBtn);
                    btnRow5.appendChild(mediumBtn);
                    btnRow5.appendChild(largeBtn);
                    buttonsSection.appendChild(btnRow5);

                    div.appendChild(buttonsSection);

                    // COLOR INPUT SECTION
                    const colorSection = document.createElement('div');
                    colorSection.className = 'demo-section';
                    colorSection.innerHTML = '<div class="demo-section-title">Color Input (SL/OS Toggle)</div>';

                    // Row 1: Basic ColorInput with toggle
                    const colorRow1 = document.createElement('div');
                    colorRow1.className = 'demo-row';
                    colorRow1.style.gap = '16px';
                    colorRow1.style.alignItems = 'center';

                    const colorLabel1 = document.createElement('span');
                    colorLabel1.textContent = 'With Toggle:';
                    colorLabel1.style.color = 'var(--text-secondary)';
                    colorLabel1.style.fontSize = '0.75rem';

                    const colorInput1 = SLUI.ColorInput({
                        r: 0.9, g: 0.27, b: 0.38,
                        showToggle: true,
                        onChange: (c) => console.log('Color 1:', c)
                    });

                    colorRow1.appendChild(colorLabel1);
                    colorRow1.appendChild(colorInput1);
                    colorSection.appendChild(colorRow1);

                    // Row 2: ColorInput without toggle (SL only)
                    const colorRow2 = document.createElement('div');
                    colorRow2.className = 'demo-row';
                    colorRow2.style.gap = '16px';
                    colorRow2.style.alignItems = 'center';
                    colorRow2.style.marginTop = '8px';

                    const colorLabel2 = document.createElement('span');
                    colorLabel2.textContent = 'SL Only:';
                    colorLabel2.style.color = 'var(--text-secondary)';
                    colorLabel2.style.fontSize = '0.75rem';

                    const colorInput2 = SLUI.ColorInput({
                        r: 0.2, g: 0.6, b: 0.9,
                        showToggle: false,
                        onChange: (c) => console.log('Color 2:', c)
                    });

                    colorRow2.appendChild(colorLabel2);
                    colorRow2.appendChild(colorInput2);
                    colorSection.appendChild(colorRow2);

                    // Row 3: SlideToggle demos
                    const colorRow3 = document.createElement('div');
                    colorRow3.className = 'demo-row';
                    colorRow3.style.gap = '24px';
                    colorRow3.style.alignItems = 'center';
                    colorRow3.style.marginTop = '12px';

                    const slideLabel = document.createElement('span');
                    slideLabel.textContent = 'SlideToggle:';
                    slideLabel.style.color = 'var(--text-secondary)';
                    slideLabel.style.fontSize = '0.75rem';

                    const toggle1 = SLUI.SlideToggle({
                        labelLeft: 'Off',
                        labelRight: 'On',
                        size: 'small'
                    });

                    const toggle2 = SLUI.SlideToggle({
                        labelLeft: 'Light',
                        labelRight: 'Dark',
                        value: true
                    });

                    colorRow3.appendChild(slideLabel);
                    colorRow3.appendChild(toggle1);
                    colorRow3.appendChild(toggle2);
                    colorSection.appendChild(colorRow3);

                    div.appendChild(colorSection);

                    return div;
                }
            });

            // ========================================
            // ORIGINAL DEMO PANELS
            // ========================================
            
            // Uniforms panel - Full uniform editor with all types and presets
            SLUI.registerPanel({
                id: 'uniforms',
                icon: 'üéöÔ∏è',
                title: 'Uniforms',
                createContent: () => {
                    const div = document.createElement('div');
                    div.style.padding = '8px';
                    div.style.display = 'flex';
                    div.style.flexDirection = 'column';
                    div.style.gap = '12px';

                    // Float section
                    const floatSection = document.createElement('div');
                    floatSection.className = 'sl-uniform-section';
                    floatSection.innerHTML = '<div class="sl-uniform-section-title">Float Uniforms</div>';
                    const floatStack = SLUI.FloatStack({
                        sliders: [
                            { name: 'u_speed', min: 0.1, max: 5.0, value: 1.0, step: 0.1 },
                            { name: 'u_scale', min: 0.1, max: 10.0, value: 1.0, step: 0.1 },
                            { name: 'u_intensity', min: 0, max: 1, value: 0.7, step: 0.01 }
                        ],
                        onChange: (v, n) => console.log(`Float ${n}: ${v}`)
                    });
                    floatSection.appendChild(floatStack);
                    div.appendChild(floatSection);

                    // Int section
                    const intSection = document.createElement('div');
                    intSection.className = 'sl-uniform-section';
                    intSection.innerHTML = '<div class="sl-uniform-section-title">Int Uniforms</div>';
                    const intStack = SLUI.IntStack({
                        sliders: [
                            { name: 'u_iterations', min: 1, max: 100, value: 32 },
                            { name: 'u_samples', min: 1, max: 16, value: 4 }
                        ],
                        onChange: (v, n) => console.log(`Int ${n}: ${v}`)
                    });
                    intSection.appendChild(intStack);
                    div.appendChild(intSection);

                    // Bool section
                    const boolSection = document.createElement('div');
                    boolSection.className = 'sl-uniform-section';
                    boolSection.innerHTML = '<div class="sl-uniform-section-title">Bool Uniforms</div>';
                    const boolStack = SLUI.BoolStack({
                        bools: [
                            { name: 'u_flip_x', checked: false },
                            { name: 'u_flip_y', checked: false },
                            { name: 'u_glow', checked: true }
                        ],
                        onChange: (c, n) => console.log(`Bool ${n}: ${c}`)
                    });
                    boolSection.appendChild(boolStack);
                    div.appendChild(boolSection);

                    // Color section
                    const colorSection = document.createElement('div');
                    colorSection.className = 'sl-uniform-section';
                    colorSection.innerHTML = '<div class="sl-uniform-section-title">Color Uniforms</div>';
                    const colorStack = SLUI.ColorStack({
                        colors: [
                            { name: 'u_color1', r: 1.0, g: 0.3, b: 0.1 },
                            { name: 'u_color2', r: 0.2, g: 0.6, b: 0.9 }
                        ],
                        onChange: (c, n) => console.log(`Color ${n}:`, c)
                    });
                    colorSection.appendChild(colorStack);
                    div.appendChild(colorSection);

                    // Vec3 section
                    const vecSection = document.createElement('div');
                    vecSection.className = 'sl-uniform-section';
                    vecSection.innerHTML = '<div class="sl-uniform-section-title">Vec3 Uniforms</div>';
                    const vecStack = SLUI.Vec3Stack({
                        vecs: [
                            { name: 'u_lightDir', x: 0.5, y: 0.7, z: 0.5, normalize: true },
                            { name: 'u_offset', x: 0, y: 0, z: 0, normalize: false }
                        ],
                        onChange: (v, n) => console.log(`Vec3 ${n}:`, v)
                    });
                    vecSection.appendChild(vecStack);
                    div.appendChild(vecSection);

                    // Actions row
                    const actions = document.createElement('div');
                    actions.className = 'sl-uniform-panel-actions';
                    
                    const randomizeBtn = document.createElement('button');
                    randomizeBtn.className = 'sl-uniform-randomize';
                    randomizeBtn.innerHTML = 'üé≤ Randomize';
                    randomizeBtn.style.cursor = 'pointer';
                    randomizeBtn.addEventListener('click', () => {
                        floatStack.randomize();
                        intStack.randomize();
                        colorStack.randomize();
                        vecStack.randomize();
                        console.log('Randomized all uniforms');
                    });
                    actions.appendChild(randomizeBtn);
                    div.appendChild(actions);

                    // Collect all data
                    function getAllData() {
                        return {
                            floats: floatStack.getData(),
                            ints: intStack.getData(),
                            bools: boolStack.getData(),
                            colors: colorStack.getData(),
                            vecs: vecStack.getData()
                        };
                    }

                    function setAllData(data) {
                        if (data.floats) floatStack.setData(data.floats);
                        if (data.ints) intStack.setData(data.ints);
                        if (data.bools) boolStack.setData(data.bools);
                        if (data.colors) colorStack.setData(data.colors);
                        if (data.vecs) vecStack.setData(data.vecs);
                    }

                    // Preset manager
                    const presetManager = SLUI.PresetManager({
                        defaultPreset: getAllData(),
                        onLoad: (data, name) => {
                            console.log(`Loading preset: ${name}`);
                            setAllData(data);
                        },
                        onSave: (name) => {
                            const data = getAllData();
                            console.log(`Saving preset: ${name}`, data);
                            return data;
                        },
                        onDelete: (name) => {
                            console.log(`Deleted preset: ${name}`);
                        }
                    });
                    div.appendChild(presetManager);

                    return div;
                }
            });
            
            // Controls panel - showcases Parameter, Icon, Timeline sliders
            SLUI.registerPanel({
                id: 'controls',
                icon: 'üéõÔ∏è',
                title: 'Controls',
                createContent: () => {
                    const div = document.createElement('div');
                    div.style.padding = '12px';
                    div.style.display = 'flex';
                    div.style.flexDirection = 'column';
                    div.style.gap = '16px';
                    
                    // Parameter Sliders section
                    const paramSection = document.createElement('div');
                    paramSection.innerHTML = '<div style="font-size: 0.7rem; color: var(--text-muted); margin-bottom: 8px; text-transform: uppercase;">Parameter Sliders</div>';
                    
                    const paramContainer = document.createElement('div');
                    paramContainer.style.display = 'flex';
                    paramContainer.style.flexDirection = 'column';
                    paramContainer.style.gap = '6px';
                    
                    // Various parameter sliders
                    paramContainer.appendChild(SLUI.ParameterSlider({
                        title: 'Brightness',
                        min: 0, max: 2, value: 1, step: 0.1,
                        onChange: (v) => console.log('Brightness:', v)
                    }));
                    
                    paramContainer.appendChild(SLUI.ParameterSlider({
                        title: 'Contrast',
                        min: 0, max: 2, value: 1, step: 0.1,
                        onChange: (v) => console.log('Contrast:', v)
                    }));
                    
                    paramContainer.appendChild(SLUI.ParameterSlider({
                        title: 'Iterations',
                        min: 1, max: 100, value: 32, step: 1, isInt: true,
                        showIncrementer: false,
                        onChange: (v) => console.log('Iterations:', v)
                    }));
                    
                    paramContainer.appendChild(SLUI.ParameterSlider({
                        title: 'Blur Radius',
                        min: 0, max: 50, value: 5, step: 1, isInt: true,
                        onChange: (v) => console.log('Blur Radius:', v)
                    }));
                    
                    paramSection.appendChild(paramContainer);
                    div.appendChild(paramSection);
                    
                    // Icon Sliders section
                    const iconSection = document.createElement('div');
                    iconSection.innerHTML = '<div style="font-size: 0.7rem; color: var(--text-muted); margin-bottom: 8px; text-transform: uppercase;">Icon Sliders</div>';
                    
                    const iconContainer = document.createElement('div');
                    iconContainer.style.display = 'flex';
                    iconContainer.style.flexDirection = 'column';
                    iconContainer.style.gap = '8px';
                    
                    iconContainer.appendChild(SLUI.IconSlider({
                        icon: 'üîä',
                        min: 0, max: 1, value: 0.7, step: 0.01,
                        onChange: (v) => console.log('Volume:', v)
                    }));
                    
                    iconContainer.appendChild(SLUI.IconSlider({
                        icon: 'üîÜ',
                        min: 0, max: 100, value: 80, step: 1, isInt: true,
                        onChange: (v) => console.log('Brightness:', v)
                    }));
                    
                    iconContainer.appendChild(SLUI.IconSlider({
                        icon: 'üìê',
                        min: 1, max: 4, value: 1, step: 1, isInt: true,
                        compact: true,
                        onChange: (v) => console.log('Pixel Size:', v)
                    }));
                    
                    iconSection.appendChild(iconContainer);
                    div.appendChild(iconSection);
                    
                    // Timeline Slider section
                    const timelineSection = document.createElement('div');
                    timelineSection.innerHTML = '<div style="font-size: 0.7rem; color: var(--text-muted); margin-bottom: 8px; text-transform: uppercase;">Timeline Slider</div>';
                    
                    const timeline = SLUI.TimelineSlider({
                        duration: 180,  // 3 minutes
                        value: 45,
                        onChange: (t) => console.log('Time:', t),
                        onSeekStart: () => console.log('Seek started'),
                        onSeekEnd: () => console.log('Seek ended')
                    });
                    
                    timelineSection.appendChild(timeline);
                    div.appendChild(timelineSection);
                    
                    return div;
                }
            });
            
            // Editor panel - Tabbed window with multiple code files
            SLUI.registerPanel({
                id: 'editor',
                icon: '<img src="icons/code32.png" srcset="icons/code64.png 2x" width="24" height="24" alt="Code">',
                title: 'Editor',
                tabbed: true,
                tabGroup: 'code',
                tabs: () => [
                    { 
                        id: 'main', 
                        label: 'main.glsl', 
                        icon: 'üìÑ',
                        content: `<div class="demo-content" style="padding: 12px;">
                            <div class="demo-code" style="font-size: 13px;">void mainImage(out vec4 fragColor, in vec2 fragCoord) {
    vec2 uv = fragCoord / iResolution.xy;
    vec3 col = 0.5 + 0.5 * cos(iTime + uv.xyx + vec3(0, 2, 4));
    fragColor = vec4(col, 1.0);
}</div>
                        </div>`
                    },
                    { 
                        id: 'common', 
                        label: 'common.glsl', 
                        icon: 'üì¶',
                        content: `<div class="demo-content" style="padding: 12px;">
                            <div class="demo-code" style="font-size: 13px;">// Shared functions and constants
#define PI 3.14159265359
#define TAU 6.28318530718

float sdSphere(vec3 p, float r) {
    return length(p) - r;
}

mat2 rot2D(float a) {
    float c = cos(a), s = sin(a);
    return mat2(c, -s, s, c);
}</div>
                        </div>`
                    },
                    { 
                        id: 'bufferA', 
                        label: 'Buffer A', 
                        icon: 'üÖ∞Ô∏è',
                        content: `<div class="demo-content" style="padding: 12px;">
                            <div class="demo-code" style="font-size: 13px;">// Buffer A - Feedback/simulation pass
void mainImage(out vec4 fragColor, in vec2 fragCoord) {
    vec2 uv = fragCoord / iResolution.xy;
    vec4 prev = texture(iChannel0, uv);
    fragColor = prev * 0.99;
}</div>
                        </div>`
                    }
                ]
            });
            
            // Preview panel - Testing SVG icon (shader)
            SLUI.registerPanel({
                id: 'preview',
                icon: '<img src="icons/shader32.png" srcset="icons/shader64.png 2x" width="24" height="24" alt="Shader">',
                title: 'Preview',
                createContent: () => {
                    const div = document.createElement('div');
                    div.className = 'demo-content';
                    div.innerHTML = `
                        <h3 class="sl-text-ui">${SLUI.t('panels.preview.liveTitle')}</h3>
                        <div class="demo-preview">
                            ${SLUI.t('panels.preview.canvasPlaceholder')}
                        </div>
                        <p style="margin-top: 12px;" class="sl-text-content">
                            ${SLUI.t('panels.preview.hint')}
                        </p>
                    `;
                    return div;
                }
            });
            
            // Inspector panel with Sliders
            SLUI.registerPanel({
                id: 'inspector',
                icon: 'üîç',
                title: 'Inspector',
                createContent: () => {
                    const div = document.createElement('div');
                    div.className = 'demo-content';
                    
                    const title = document.createElement('h3');
                    title.className = 'sl-text-ui';
                    title.textContent = SLUI.t('panels.inspector.propertiesTitle');
                    div.appendChild(title);
                    
                    // Add slider controls
                    const radiusSlider = SLUI.SliderGroup({
                        label: SLUI.t('panels.inspector.radius'),
                        min: 0, max: 100, value: 50
                    });
                    div.appendChild(radiusSlider);
                    
                    const smoothSlider = SLUI.SliderGroup({
                        label: SLUI.t('panels.inspector.smoothness'),
                        min: 0, max: 100, value: 30
                    });
                    div.appendChild(smoothSlider);
                    
                    // Color picker
                    const colorGroup = document.createElement('div');
                    colorGroup.className = 'sl-slider-group';
                    colorGroup.innerHTML = `
                        <label class="sl-slider-group-label">${SLUI.t('panels.inspector.color')}</label>
                        <input type="color" value="#e94560" style="width: 100%; height: 32px; border: none; cursor: pointer; border-radius: var(--border-radius);">
                    `;
                    div.appendChild(colorGroup);
                    
                    return div;
                }
            });
            
            // Library panel
            SLUI.registerPanel({
                id: 'library',
                icon: 'üìö',
                title: 'Library',
                createContent: () => {
                    const div = document.createElement('div');
                    div.className = 'demo-content';
                    const items = ['raymarching', 'fractalNoise', 'pbrLighting', 'postProcessing', 'volumetricFog'];
                    div.innerHTML = `
                        <h3 class="sl-text-ui">${SLUI.t('panels.library.title')}</h3>
                        <input type="text" class="sl-input" placeholder="${SLUI.t('panels.library.searchPlaceholder')}" style="width: 100%; margin-bottom: 12px;">
                        <div style="display: flex; flex-direction: column; gap: 8px;">
                            ${items.map(key => `
                                <div style="padding: 8px 12px; background: var(--bg-secondary); border-radius: var(--border-radius); cursor: pointer; transition: background var(--transition);" onmouseover="this.style.background='var(--bg-hover)'" onmouseout="this.style.background='var(--bg-secondary)'">
                                    <div style="font-weight: 500;">${SLUI.t('panels.library.items.' + key)}</div>
                                    <div style="font-size: 0.75rem; color: var(--text-muted);">${SLUI.t('panels.library.templateLabel')}</div>
                                </div>
                            `).join('')}
                        </div>
                    `;
                    return div;
                }
            });
            
            // Console panel - Testing SVG icon
            SLUI.registerPanel({
                id: 'console',
                icon: '<img src="icons/console32.png" srcset="icons/console64.png 2x" width="24" height="24" alt="Console">',
                title: 'Console',
                createContent: () => {
                    const div = document.createElement('div');
                    div.className = 'demo-content';
                    div.innerHTML = `
                        <h3 class="sl-text-ui">${SLUI.t('panels.console.outputTitle')}</h3>
                        <div style="font-family: var(--font-code); font-size: 0.8rem; background: var(--bg-primary); padding: 12px; border-radius: var(--border-radius); border: 1px solid var(--border); height: 200px; overflow: auto;">
                            <div style="color: var(--success);">[INFO] ${SLUI.t('panels.console.messages.compiled')}</div>
                            <div style="color: var(--text-muted);">[DEBUG] ${SLUI.t('panels.console.messages.frameTime')}</div>
                            <div style="color: var(--warning);">[WARN] ${SLUI.t('panels.console.messages.unusedUniform')}</div>
                            <div style="color: var(--text-muted);">[DEBUG] ${SLUI.t('panels.console.messages.resolution')}</div>
                            <div style="color: var(--success);">[INFO] ${SLUI.t('panels.console.messages.previewUpdated')}</div>
                        </div>
                    `;
                    return div;
                }
            });
            
            // Profile panel (hidden from toolbar)
            SLUI.registerPanel({
                id: 'profile',
                icon: 'üë§',
                title: 'Profile',
                createContent: SLUI.createProfileContent,
                showInToolbar: false
            });
            
            // Settings panel
            SLUI.registerPanel({
                id: 'settings',
                icon: '‚öô',
                title: 'Settings',
                createContent: SLUI.createSettingsContent
            });
            
            // Open components panel by default on desktop
            if (SLUI.state.deviceMode !== 'mobile') {
                setTimeout(() => {
                    document.querySelector('[data-panel-id="uniforms"]')?.click();
                }, 300);
            }
            
            console.log('Device mode:', SLUI.state.deviceMode);
            console.log('Is mobile device:', SLUI.isMobileDevice());
            
            // ========================================
            // TABBED WINDOWS DEMO
            // Press 'T' to spawn demo tabbed windows
            // ========================================
            
            let tabbedWindowCounter = 0;
            
            document.addEventListener('keydown', (e) => {
                if (e.key === 't' || e.key === 'T') {
                    if (e.target.tagName === 'INPUT' || e.target.tagName === 'TEXTAREA') return;
                    
                    tabbedWindowCounter++;
                    const floatLayer = document.getElementById('sl-float-layer');
                    
                    // Create a code tabbed window
                    const codeWin = SLUI.createTabbedWindow({
                        id: `code-win-${tabbedWindowCounter}`,
                        group: 'code',
                        x: 150 + tabbedWindowCounter * 40,
                        y: 100 + tabbedWindowCounter * 30,
                        width: 500,
                        height: 400,
                        tabs: [
                            { id: `main-${tabbedWindowCounter}`, label: 'main.glsl', icon: 'üìÑ', 
                              content: '<div style="padding: 12px; font-family: var(--font-code); color: var(--text-secondary);">// Main shader<br>void mainImage(out vec4 c, in vec2 p) {<br>&nbsp;&nbsp;c = vec4(p/iResolution.xy, 0.5, 1.0);<br>}</div>' },
                            { id: `common-${tabbedWindowCounter}`, label: 'common.glsl', icon: 'üì¶', 
                              content: '<div style="padding: 12px; font-family: var(--font-code); color: var(--text-secondary);">// Common functions<br>#define PI 3.14159265</div>' }
                        ]
                    });
                    
                    if (codeWin && floatLayer) {
                        floatLayer.appendChild(codeWin);
                        console.log('Created tabbed window:', codeWin.dataset.windowId);
                        console.log('Press T again to create another window.');
                        console.log('Drag tabs between windows of the same group!');
                    }
                }
            });
            
            // Add visual hint for the tabbed window demo
            if (SLUI.state.deviceMode !== 'mobile') {
                const hint = document.createElement('div');
                hint.style.cssText = 'position: fixed; bottom: 10px; left: 50%; transform: translateX(-50%); background: var(--bg-tertiary); border: 1px solid var(--border); padding: 8px 16px; border-radius: 6px; font-size: 12px; color: var(--text-muted); z-index: 9999; pointer-events: none;';
                hint.textContent = 'Click Editor icon to open a Tabbed Window - drag tabs to reorder or drag out!';
                document.body.appendChild(hint);
                setTimeout(() => hint.remove(), 8000);
            }
            
            console.log('Click the Editor icon (code) to open a Tabbed Window demo.');
            console.log('Press T to create additional code windows for testing tab drag between windows.');
            
        });
    </script>
</body>
</html>
